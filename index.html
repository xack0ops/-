<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>약분/통분 오목 게임 (10x10)</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Gaegu:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Gaegu', cursive;
            background-color: #FFFAF0;
            color: #333;
            min-height: 100vh;
        }
        
        .game-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .start-screen, .game-screen, .result-screen {
            background-color: #FFECB3;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .game-title {
            color: #FF6B6B;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        .game-button {
            background-color: #4ECDC4;
            color: white;
            border-radius: 15px;
            padding: 12px 24px;
            font-size: 1.2rem;
            font-weight: bold;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 0 #2E9D95;
        }
        
        .game-button:hover {
            background-color: #35B5AD;
            transform: translateY(-2px);
        }
        
        .game-button:active {
            box-shadow: 0 2px 0 #2E9D95;
            transform: translateY(2px);
        }
        
        .board {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 2px;
            margin: 20px auto;
            background-color: #DEB887;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .cell {
            background-color: #F5DEB3;
            aspect-ratio: 1/1;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.2s;
            position: relative;
            font-size: 0.8rem;
        }
        
        .cell:hover {
            background-color: #FFEFD5;
            transform: scale(1.05);
        }
        
        .fraction {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        
        .fraction-line {
            width: 100%;
            height: 1px;
            background-color: black;
            margin: 1px 0;
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(0,0,0,0.5);
            z-index: 100;
        }
        
        .modal-content {
            background-color: #FFFAF0;
            border-radius: 20px;
            padding: 30px;
            max-width: 80%;
            text-align: center;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
        }
        
        .player-indicator {
            padding: 10px;
            border-radius: 15px;
            margin: 10px 0;
            font-weight: bold;
        }
        
        .player1 {
            background-color: #FF6B6B;
            color: white;
        }
        
        .player2 {
            background-color: #4ECDC4;
            color: white;
        }
        
        .stone-player1 {
            background-color: #FF6B6B;
            border-radius: 50%;
            width: 80%;
            height: 80%;
        }
        
        .stone-player2 {
            background-color: #4ECDC4;
            border-radius: 50%;
            width: 80%;
            height: 80%;
        }
        
        .warning {
            background-color: #FF9A8B;
            color: #6A0E00;
            padding: 10px;
            border-radius: 10px;
            margin: 15px 0;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .fraction-input {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
        }
        
        .fraction-input-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 10px;
        }
        
        .fraction-input input {
            width: 60px;
            height: 40px;
            text-align: center;
            font-size: 1.5rem;
            border: 2px solid #DEB887;
            border-radius: 5px;
        }
        
        .fraction-divider {
            width: 80px;
            height: 2px;
            background-color: black;
            margin: 5px 0;
        }
        
        .score {
            font-size: 1.2rem;
            margin: 10px 0;
        }
        
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #f00;
            border-radius: 50%;
            animation: fall 3s linear forwards;
        }
        
        @keyframes fall {
            to {
                transform: translateY(100vh) rotate(360deg);
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1 class="text-4xl font-bold text-center my-6 game-title">약분/통분 오목 게임</h1>
        
        <!-- Start Screen -->
        <div id="start-screen" class="start-screen text-center">
            <h2 class="text-2xl font-bold mb-8">게임 모드를 선택하세요</h2>
            <div class="flex flex-col md:flex-row justify-center gap-4 mb-4">
                <button id="yakbun-btn" class="game-button bg-red-400 hover:bg-red-500">약분 오목</button>
                <button id="tongbun-btn" class="game-button bg-blue-400 hover:bg-blue-500">통분 오목</button>
            </div>
            <p class="mt-6 text-xl">초등학교 5학년을 위한 분수 학습 게임입니다.<br>문제를 맞추고 오목을 완성해보세요!</p>
            <div class="mt-8 text-left p-4 bg-yellow-100 rounded-lg">
                <h3 class="font-bold mb-2">게임 방법</h3>
                <p><strong>약분 오목:</strong> 주어진 분수를 기약분수로 약분하세요.</p>
                <p><strong>통분 오목:</strong> 두 분수를 같은 분모로 통분하세요.</p>
                <p class="mt-4"><strong>승리 조건:</strong> 가로, 세로, 대각선 중 5개를 먼저 연결하면 승리!</p>
            </div>
        </div>
        
        <!-- Game Screen -->
        <div id="game-screen" class="game-screen hidden">
            <div class="flex justify-between items-center mb-4">
                <h2 id="game-mode-title" class="text-2xl font-bold">약분 오목</h2>
                <button id="back-btn" class="game-button bg-yellow-500 hover:bg-yellow-600 px-4 py-2">메인으로</button>
            </div>
            
            <div class="flex justify-between mb-4">
                <div id="player1" class="player-indicator player1 w-1/2 mx-1">플레이어 1의 차례</div>
                <div id="player2" class="player-indicator player2 w-1/2 mx-1 opacity-50">플레이어 2</div>
            </div>
            
            <div id="warning" class="warning hidden">
                상대방이 3개를 연속으로 연결했습니다! 막아야 해요!
            </div>
            
            <div class="score">
                <p>플레이어 1: <span id="score1">0</span> | 플레이어 2: <span id="score2">0</span></p>
            </div>
            
            <div id="board" class="board"></div>
        </div>
        
        <!-- Result Screen -->
        <div id="result-screen" class="result-screen hidden text-center">
            <h2 class="text-3xl font-bold mb-4">게임 종료!</h2>
            <div id="winner-message" class="text-2xl mb-6"></div>
            <div class="mb-8">
                <p>최종 점수</p>
                <p>플레이어 1: <span id="final-score1">0</span> | 플레이어 2: <span id="final-score2">0</span></p>
            </div>
            <button id="play-again-btn" class="game-button bg-green-500 hover:bg-green-600">다시 하기</button>
        </div>
    </div>
    
    <!-- Problem Modal -->
    <div id="problem-modal" class="modal hidden">
        <div class="modal-content">
            <h3 id="problem-title" class="text-2xl font-bold mb-4">분수 문제</h3>
            <div id="problem-content" class="text-xl mb-6"></div>
            
            <div id="yakbun-input" class="fraction-input hidden">
                <div class="fraction-input-group">
                    <input type="number" id="yakbun-numerator" min="1" max="100">
                    <div class="fraction-divider"></div>
                    <input type="number" id="yakbun-denominator" min="1" max="100">
                </div>
            </div>
            
            <div id="tongbun-input" class="fraction-input hidden">
                <div class="fraction-input-group mr-4">
                    <input type="number" id="tongbun-numerator1" min="1" max="100">
                    <div class="fraction-divider"></div>
                    <input type="number" id="tongbun-denominator1" min="1" max="100">
                </div>
                <div class="text-2xl mx-2">,</div>
                <div class="fraction-input-group ml-4">
                    <input type="number" id="tongbun-numerator2" min="1" max="100">
                    <div class="fraction-divider"></div>
                    <input type="number" id="tongbun-denominator2" min="1" max="100">
                </div>
            </div>
            
            <div class="flex justify-center gap-4 mt-6">
                <button id="submit-answer" class="game-button bg-green-500 hover:bg-green-600">확인</button>
                <button id="close-modal" class="game-button bg-gray-500 hover:bg-gray-600">취소</button>
            </div>
            
            <div id="hint" class="mt-4 text-gray-700 hidden"></div>
        </div>
    </div>

    <script>
        // Game variables
        let gameMode = ''; // 'yakbun' or 'tongbun'
        let currentPlayer = 1;
        let boardState = [];
        let currentCell = null;
        let currentProblem = null;
        let scores = { 1: 0, 2: 0 };
        let gameOver = false;
        
        // DOM Elements
        const startScreen = document.getElementById('start-screen');
        const gameScreen = document.getElementById('game-screen');
        const resultScreen = document.getElementById('result-screen');
        const problemModal = document.getElementById('problem-modal');
        const yakbunInput = document.getElementById('yakbun-input');
        const tongbunInput = document.getElementById('tongbun-input');
        const board = document.getElementById('board');
        const player1Indicator = document.getElementById('player1');
        const player2Indicator = document.getElementById('player2');
        const warning = document.getElementById('warning');
        const gameModeTitle = document.getElementById('game-mode-title');
        const problemTitle = document.getElementById('problem-title');
        const problemContent = document.getElementById('problem-content');
        const hint = document.getElementById('hint');
        
        // Initialize Game
        function initializeGame() {
            // Event Listeners
            document.getElementById('yakbun-btn').addEventListener('click', () => startGame('yakbun'));
            document.getElementById('tongbun-btn').addEventListener('click', () => startGame('tongbun'));
            document.getElementById('back-btn').addEventListener('click', goToMain);
            document.getElementById('play-again-btn').addEventListener('click', goToMain);
            document.getElementById('submit-answer').addEventListener('click', checkAnswer);
            document.getElementById('close-modal').addEventListener('click', closeModal);
        }
        
        // Go to main menu
        function goToMain() {
            startScreen.classList.remove('hidden');
            gameScreen.classList.add('hidden');
            resultScreen.classList.add('hidden');
        }
        
        // Start the game with selected mode
        function startGame(mode) {
            gameMode = mode;
            gameOver = false;
            currentPlayer = 1;
            scores = { 1: 0, 2: 0 };
            
            // Update UI
            startScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            resultScreen.classList.add('hidden');
            
            // Set game mode title
            gameModeTitle.textContent = mode === 'yakbun' ? '약분 오목' : '통분 오목';
            
            // Update player indicators
            updatePlayerIndicators();
            
            // Create board
            createBoard();
            
            // Update scores
            updateScores();
            
            // Hide warning
            warning.classList.add('hidden');
        }
        
        // Create the game board
        function createBoard() {
            board.innerHTML = '';
            boardState = [];
            
            for (let i = 0; i < 10; i++) {
                boardState[i] = [];
                for (let j = 0; j < 10; j++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.dataset.row = i;
                    cell.dataset.col = j;
                    
                    // Generate random fraction problem based on game mode
                    let problem;
                    if (gameMode === 'yakbun') {
                        problem = generateYakbunProblem();
                    } else {
                        problem = generateTongbunProblem();
                    }
                    
                    // Store problem in board state
                    boardState[i][j] = {
                        player: 0, // 0 = empty, 1 = player1, 2 = player2
                        problem: problem
                    };
                    
                    // Display fraction in cell
                    if (gameMode === 'yakbun') {
                        const fraction = document.createElement('div');
                        fraction.className = 'fraction';
                        
                        const numerator = document.createElement('div');
                        numerator.textContent = problem.numerator;
                        
                        const line = document.createElement('div');
                        line.className = 'fraction-line';
                        
                        const denominator = document.createElement('div');
                        denominator.textContent = problem.denominator;
                        
                        fraction.appendChild(numerator);
                        fraction.appendChild(line);
                        fraction.appendChild(denominator);
                        
                        cell.appendChild(fraction);
                    } else {
                        cell.textContent = '?';
                    }
                    
                    // Add click event
                    cell.addEventListener('click', () => onCellClick(i, j));
                    
                    board.appendChild(cell);
                }
            }
        }
        
        // Generate a yakbun problem (fraction that can be reduced)
        function generateYakbunProblem() {
            // Generate a reducible fraction
            let denominator = Math.floor(Math.random() * 11) + 2; // 2-12
            let numerator;
            let gcd = 1;
            
            // Ensure we have a reducible fraction
            do {
                numerator = Math.floor(Math.random() * (denominator - 1)) + 1; // 1 to (denominator-1)
                gcd = findGCD(numerator, denominator);
            } while (gcd === 1 || numerator === 1); // Exclude already reduced fractions and 1/n fractions
            
            // Calculate the reduced form
            let reducedNumerator = numerator / gcd;
            let reducedDenominator = denominator / gcd;
            
            return {
                numerator,
                denominator,
                reducedNumerator,
                reducedDenominator
            };
        }
        
        // Generate a tongbun problem (two fractions to find common denominator)
        function generateTongbunProblem() {
            // Generate two different fractions with different denominators
            let denominator1 = Math.floor(Math.random() * 9) + 2; // 2-10
            let denominator2;
            
            // Ensure we have different denominators
            do {
                denominator2 = Math.floor(Math.random() * 9) + 2; // 2-10
            } while (denominator2 === denominator1);
            
            // Generate numerators
            let numerator1 = Math.floor(Math.random() * (denominator1 - 1)) + 1; // 1 to (denominator1-1)
            let numerator2 = Math.floor(Math.random() * (denominator2 - 1)) + 1; // 1 to (denominator2-1)
            
            // Find LCM for common denominator
            let lcm = findLCM(denominator1, denominator2);
            
            // Calculate equivalent fractions with common denominator
            let commonNumerator1 = numerator1 * (lcm / denominator1);
            let commonNumerator2 = numerator2 * (lcm / denominator2);
            
            return {
                fraction1: {
                    numerator: numerator1,
                    denominator: denominator1
                },
                fraction2: {
                    numerator: numerator2,
                    denominator: denominator2
                },
                commonDenominator: lcm,
                commonNumerator1,
                commonNumerator2
            };
        }
        
        // Find greatest common divisor (GCD) using Euclidean algorithm
        function findGCD(a, b) {
            while (b) {
                let temp = b;
                b = a % b;
                a = temp;
            }
            return a;
        }
        
        // Find least common multiple (LCM)
        function findLCM(a, b) {
            return (a * b) / findGCD(a, b);
        }
        
        // Handle cell click
        function onCellClick(row, col) {
            // Ignore if game is over or cell is already taken
            if (gameOver || boardState[row][col].player !== 0) {
                return;
            }
            
            currentCell = { row, col };
            currentProblem = boardState[row][col].problem;
            
            // Show problem modal
            problemModal.classList.remove('hidden');
            
            // Set up problem display and inputs
            if (gameMode === 'yakbun') {
                yakbunInput.classList.remove('hidden');
                tongbunInput.classList.add('hidden');
                
                problemTitle.textContent = '약분 문제';
                problemContent.innerHTML = `
                    <div class="text-center">
                        다음 분수를 기약분수로 약분하세요:
                        <div class="flex justify-center items-center my-4">
                            <div class="fraction text-3xl">
                                <div>${currentProblem.numerator}</div>
                                <div class="fraction-divider"></div>
                                <div>${currentProblem.denominator}</div>
                            </div>
                        </div>
                    </div>
                `;
                
                // Clear inputs
                document.getElementById('yakbun-numerator').value = '';
                document.getElementById('yakbun-denominator').value = '';
            } else {
                yakbunInput.classList.add('hidden');
                tongbunInput.classList.remove('hidden');
                
                problemTitle.textContent = '통분 문제';
                problemContent.innerHTML = `
                    <div class="text-center">
                        다음 두 분수를 같은 분모로 통분하세요:
                        <div class="flex justify-center items-center my-4">
                            <div class="fraction text-3xl mx-2">
                                <div>${currentProblem.fraction1.numerator}</div>
                                <div class="fraction-divider"></div>
                                <div>${currentProblem.fraction1.denominator}</div>
                            </div>
                            <div class="text-3xl mx-2">,</div>
                            <div class="fraction text-3xl mx-2">
                                <div>${currentProblem.fraction2.numerator}</div>
                                <div class="fraction-divider"></div>
                                <div>${currentProblem.fraction2.denominator}</div>
                            </div>
                        </div>
                    </div>
                `;
                
                // Clear inputs
                document.getElementById('tongbun-numerator1').value = '';
                document.getElementById('tongbun-denominator1').value = '';
                document.getElementById('tongbun-numerator2').value = '';
                document.getElementById('tongbun-denominator2').value = '';
            }
            
            // Hide hint
            hint.classList.add('hidden');
            hint.textContent = '';
        }
        
        // Check the answer
        function checkAnswer() {
            let isCorrect = false;
            
            if (gameMode === 'yakbun') {
                const userNumerator = parseInt(document.getElementById('yakbun-numerator').value);
                const userDenominator = parseInt(document.getElementById('yakbun-denominator').value);
                
                // Check if the answer is correct
                isCorrect = userNumerator === currentProblem.reducedNumerator && 
                           userDenominator === currentProblem.reducedDenominator;
                           
                // Show hint if incorrect
                if (!isCorrect) {
                    hint.classList.remove('hidden');
                    hint.textContent = `다시 생각해보세요! ${currentProblem.numerator}와 ${currentProblem.denominator}의 최대공약수를 찾아 약분해보세요.`;
                }
            } else {
                const userNumerator1 = parseInt(document.getElementById('tongbun-numerator1').value);
                const userDenominator1 = parseInt(document.getElementById('tongbun-denominator1').value);
                const userNumerator2 = parseInt(document.getElementById('tongbun-numerator2').value);
                const userDenominator2 = parseInt(document.getElementById('tongbun-denominator2').value);
                
                // Check if user's answers are valid common fractions
                if (userDenominator1 === userDenominator2) {
                    // Check if the values are correct
                    const isDenominatorCorrect = userDenominator1 === currentProblem.commonDenominator || 
                                               (userDenominator1 % currentProblem.commonDenominator === 0 && 
                                               userNumerator1 * (userDenominator1 / currentProblem.commonDenominator) === currentProblem.commonNumerator1 * (userDenominator1 / currentProblem.commonDenominator) &&
                                               userNumerator2 * (userDenominator1 / currentProblem.commonDenominator) === currentProblem.commonNumerator2 * (userDenominator1 / currentProblem.commonDenominator));
                    
                    const isNumerator1Correct = userNumerator1 * (currentProblem.commonDenominator / userDenominator1) === currentProblem.commonNumerator1 || 
                                              userNumerator1 === currentProblem.commonNumerator1 * (userDenominator1 / currentProblem.commonDenominator);
                                              
                    const isNumerator2Correct = userNumerator2 * (currentProblem.commonDenominator / userDenominator1) === currentProblem.commonNumerator2 || 
                                              userNumerator2 === currentProblem.commonNumerator2 * (userDenominator1 / currentProblem.commonDenominator);
                    
                    isCorrect = isDenominatorCorrect && isNumerator1Correct && isNumerator2Correct;
                }
                
                // Show hint if incorrect
                if (!isCorrect) {
                    hint.classList.remove('hidden');
                    hint.textContent = `다시 생각해보세요! ${currentProblem.fraction1.denominator}와 ${currentProblem.fraction2.denominator}의 최소공배수를 찾아 통분해보세요.`;
                }
            }
            
            if (isCorrect) {
                // Mark cell as taken by current player
                boardState[currentCell.row][currentCell.col].player = currentPlayer;
                
                // Update cell display
                updateCell(currentCell.row, currentCell.col);
                
                // Increment score
                scores[currentPlayer]++;
                updateScores();
                
                // Check for win
                if (checkForWin(currentCell.row, currentCell.col)) {
                    // Game over
                    gameOver = true;
                    showGameResult();
                } else {
                    // Switch player
                    switchPlayer();
                    
                    // Check for potential win threat
                    checkForThreat();
                }
                
                // Close modal
                closeModal();
            }
        }
        
        // Update cell display based on board state
        function updateCell(row, col) {
            const cell = document.querySelector(`[data-row="${row}"][data-col="${col}"]`);
            cell.innerHTML = '';
            
            if (boardState[row][col].player > 0) {
                const stone = document.createElement('div');
                stone.className = `stone-player${boardState[row][col].player}`;
                cell.appendChild(stone);
            }
        }
        
        // Switch to next player
        function switchPlayer() {
            currentPlayer = currentPlayer === 1 ? 2 : 1;
            updatePlayerIndicators();
        }
        
        // Update player indicators
        function updatePlayerIndicators() {
            if (currentPlayer === 1) {
                player1Indicator.classList.remove('opacity-50');
                player1Indicator.textContent = '플레이어 1의 차례';
                player2Indicator.classList.add('opacity-50');
                player2Indicator.textContent = '플레이어 2';
            } else {
                player1Indicator.classList.add('opacity-50');
                player1Indicator.textContent = '플레이어 1';
                player2Indicator.classList.remove('opacity-50');
                player2Indicator.textContent = '플레이어 2의 차례';
            }
        }
        
        // Update scores display
        function updateScores() {
            document.getElementById('score1').textContent = scores[1];
            document.getElementById('score2').textContent = scores[2];
            document.getElementById('final-score1').textContent = scores[1];
            document.getElementById('final-score2').textContent = scores[2];
        }
        
        // Close the problem modal
        function closeModal() {
            problemModal.classList.add('hidden');
        }
        
        // Check for win
        function checkForWin(row, col) {
            const player = boardState[row][col].player;
            const directions = [
                [0, 1], // horizontal
                [1, 0], // vertical
                [1, 1], // diagonal down-right
                [1, -1] // diagonal down-left
            ];
            
            // Check each direction
            for (const [dr, dc] of directions) {
                let count = 1; // start with current cell
                
                // Check in positive direction
                for (let i = 1; i <= 4; i++) {
                    const r = row + dr * i;
                    const c = col + dc * i;
                    
                    if (r < 0 || r >= 10 || c < 0 || c >= 10 || boardState[r][c].player !== player) {
                        break;
                    }
                    
                    count++;
                }
                
                // Check in negative direction
                for (let i = 1; i <= 4; i++) {
                    const r = row - dr * i;
                    const c = col - dc * i;
                    
                    if (r < 0 || r >= 10 || c < 0 || c >= 10 || boardState[r][c].player !== player) {
                        break;
                    }
                    
                    count++;
                }
                
                // Check if we have 5 in a row
                if (count >= 5) {
                    return true;
                }
            }
            
            return false;
        }
        
        // Check for threat (3 or 4 in a row)
        function checkForThreat() {
            // The player who just played made the potential threat
            const player = currentPlayer === 1 ? 2 : 1;
            
            for (let row = 0; row < 10; row++) {
                for (let col = 0; col < 10; col++) {
                    if (boardState[row][col].player === player) {
                        const threat = checkForConsecutiveStones(row, col, player);
                        if (threat >= 3) {
                            warning.classList.remove('hidden');
                            return;
                        }
                    }
                }
            }
            
            warning.classList.add('hidden');
        }
        
        // Check for consecutive stones from a position
        function checkForConsecutiveStones(row, col, player) {
            const directions = [
                [0, 1], // horizontal
                [1, 0], // vertical
                [1, 1], // diagonal down-right
                [1, -1] // diagonal down-left
            ];
            
            let maxCount = 0;
            
            // Check each direction
            for (const [dr, dc] of directions) {
                let count = 1; // start with current cell
                
                // Check in positive direction
                for (let i = 1; i <= 4; i++) {
                    const r = row + dr * i;
                    const c = col + dc * i;
                    
                    if (r < 0 || r >= 10 || c < 0 || c >= 10 || boardState[r][c].player !== player) {
                        break;
                    }
                    
                    count++;
                }
                
                // Check in negative direction
                for (let i = 1; i <= 4; i++) {
                    const r = row - dr * i;
                    const c = col - dc * i;
                    
                    if (r < 0 || r >= 10 || c < 0 || c >= 10 || boardState[r][c].player !== player) {
                        break;
                    }
                    
                    count++;
                }
                
                maxCount = Math.max(maxCount, count);
            }
            
            return maxCount;
        }
        
        // Show game result
        function showGameResult() {
            gameScreen.classList.add('hidden');
            resultScreen.classList.remove('hidden');
            
            const winner = document.getElementById('winner-message');
            if (currentPlayer === 1) {
                winner.textContent = '🎉 플레이어 1이 승리했습니다! 🎉';
                winner.className = 'text-2xl mb-6 text-red-500 font-bold';
            } else {
                winner.textContent = '🎉 플레이어 2가 승리했습니다! 🎉';
                winner.className = 'text-2xl mb-6 text-blue-500 font-bold';
            }
            
            // Show final scores
            updateScores();
            
            // Create confetti
            createConfetti();
        }
        
        // Create confetti effect
        function createConfetti() {
            const colors = ['#FF6B6B', '#4ECDC4', '#FFD166', '#06D6A0', '#FF9A8B'];
            
            for (let i = 0; i < 100; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.animationDuration = (Math.random() * 3 + 2) + 's';
                confetti.style.opacity = Math.random();
                document.body.appendChild(confetti);
                
                // Remove confetti after animation
                setTimeout(() => {
                    confetti.remove();
                }, 5000);
            }
        }
        
        // Initialize game when page loads
        window.onload = function() {
  initializeGame();
  console.log("게임 초기화 완료!");
};
    </script>
</body>
</html>
